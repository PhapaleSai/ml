###DO NOT TAKE THIS SLIP
# SLip 13A Diffcuilt dont take it 
# Create RNN model and analyze the Google stock price dataset. Find out increasing or     
#decreasing trends of stock price for the next day

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import MinMaxScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import SimpleRNN, Dense

# Load Google stock price dataset
df = pd.read_csv('GOOGL_Stock.csv')  # Make sure it has 'Close' column
prices = df['Close'].values.reshape(-1,1)

# Scale prices
scaler = MinMaxScaler()
scaled_prices = scaler.fit_transform(prices)

# Prepare data (past 5 days to predict next day trend)
time_step = 5
X, y = [], []
for i in range(len(scaled_prices)-time_step-1):
    X.append(scaled_prices[i:i+time_step, 0])
    y.append(1 if scaled_prices[i+time_step, 0] > scaled_prices[i+time_step-1, 0] else 0)

X = np.array(X).reshape(-1, time_step, 1)
y = np.array(y)

# Build simple RNN
model = Sequential()
model.add(SimpleRNN(20, activation='relu', input_shape=(time_step,1)))
model.add(Dense(1, activation='sigmoid'))
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Train model
model.fit(X, y, epochs=20, batch_size=16, verbose=1)

# Predict next day trend
last_sequence = scaled_prices[-time_step:].reshape(1, time_step, 1)
pred = model.predict(last_sequence)[0][0]
trend = "Increase" if pred >= 0.5 else "Decrease"
print(f"Predicted next day trend: {trend}")

# Plot past prices
plt.figure(figsize=(10,5))
plt.plot(df['Close'], label='Historical Prices', color='blue')
plt.scatter(len(prices), prices[-1]*1.01 if trend=="Increase" else prices[-1]*0.99, 
            color='red', marker='X', s=150, label=f'Next Day Predicted: {trend}')
plt.xlabel('Days')
plt.ylabel('Google Stock Price')
plt.title('Google Stock Price and Next Day Trend Prediction')
plt.legend()
plt.show()
--------------------------------------------------------------
## Slip 2A,4B,13B,22A
 ##Write a python program to implement simple Linear Regression for predicting house   
##price. First find all null values in a given dataset and remove them.

 # Import necessary libraries
 import pandas as pd
 from sklearn.model_selection import train_test_split
 from sklearn.linear_model import LinearRegression
 from sklearn.metrics import mean_squared_error
 
# Sample data (or load your data as df = pd.read_csv("your_dataset.csv"))
 data = {
    'size': [1500, 2000, 2500, None, 3000, 3500, 4000, None],
    'price': [300000, 400000, 500000, 450000, 600000, 700000, 800000, None]
 }
 df = pd.DataFrame(data)
 
# 1. Check and remove null values
 df = df.dropna()
 
# 2. Separate features and target variable
 X = df[['size']]   # Feature (independent variable)
 y = df['price']    # Target (dependent variable)
 
# 3. Split data into training and testing sets
 X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
 
# 4. Initialize and train the Linear Regression model
 model = LinearRegression()
 model.fit(X_train, y_train)
 
# 5. Predict and evaluate the model
 y_pred = model.predict(X_test)
 mse = mean_squared_error(y_test, y_pred)
 print("Mean Squared Error:", mse)
 
# 6. Display model prediction for test data
 print("Predicted House Prices:", y_pred)

----------------------------------------------------------------------------------------
